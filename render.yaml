services:
  - type: web
    name: photobomb-backend
    runtime: docker
    region: singapore # Closest to Sydney (Supabase)
    plan: free
    dockerContext: ./backend
    dockerfilePath: ./backend/Dockerfile
    # Use our custom script to run both Worker and Web in one container (Save $$)
    # startCommand moved to Dockerfile
    envVars:
      - key: PORT
        value: 10000
      - key: PYTHON_VERSION
        value: 3.11.0
      - key: DATABASE_URL
        sync: false # User will input this in dashboard
      - key: REDIS_URL
        sync: false
      - key: B2_APPLICATION_KEY_ID
        sync: false
      - key: B2_APPLICATION_KEY
        sync: false
      - key: B2_BUCKET_NAME
        sync: false
      - key: B2_BUCKET_ID
        sync: false
      - key: JWT_SECRET_KEY
        sync: false
      - key: ALLOWED_ORIGINS
        sync: false
      - key: GOOGLE_CLIENT_ID
        sync: false
      - key: GOOGLE_CLIENT_SECRET
        sync: false
      - key: APP_NAME
        value: PhotoBomb
      - key: APP_ENV
        value: production
      - key: DEBUG
        value: "false"
      - key: DATABASE_POOL_SIZE
        value: "20"
      - key: DATABASE_MAX_OVERFLOW
        value: "10"
      - key: JWT_ALGORITHM
        value: HS256
      - key: JWT_ACCESS_TOKEN_EXPIRE_MINUTES
        value: "60"
      - key: JWT_REFRESH_TOKEN_EXPIRE_DAYS
        value: "30"
