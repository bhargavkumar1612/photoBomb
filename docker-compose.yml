services:
  # FastAPI backend
  api:
    build:
      context: ./backend
      dockerfile: Dockerfile.backend
    ports:
      - "8000:8000"
    # Pass all env vars from host (which reads .env) to container
    environment:
      - DATABASE_URL
      - REDIS_URL
      - JWT_SECRET_KEY
      - B2_APPLICATION_KEY_ID
      - B2_APPLICATION_KEY
      - B2_BUCKET_NAME
      - B2_BUCKET_ID
      - GOOGLE_CLIENT_ID
      - GOOGLE_CLIENT_SECRET
      - APP_ENV
    volumes:
      - ./backend:/app
    command: uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload
