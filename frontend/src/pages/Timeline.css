/* Timeline Header & Layout */
.timeline-wrapper {
    margin: -24px;
    /* Counteract AppLayout padding */
    display: flex;
    flex-direction: column;
    min-height: calc(100vh - 64px);
    /* Ensure full height */
}

.timeline-layout-container {
    display: flex;
    flex-direction: column;
}

.timeline-sub-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 12px 40px;
    background: rgba(255, 255, 255, 0.75);
    position: sticky;
    top: 0;
    z-index: 100;
    backdrop-filter: blur(20px) saturate(180%);
    -webkit-backdrop-filter: blur(20px) saturate(180%);
    border-bottom: 1px solid rgba(0, 0, 0, 0.08);
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.timeline-sub-header.selection-mode {
    background: rgba(79, 70, 229, 0.1);
    border-bottom: 1px solid rgba(79, 70, 229, 0.2);
}

/* Tabs: Photos | Favorites */
.sub-header-left {
    display: flex;
    gap: 24px;
    align-items: center;
}

.header-tab {
    font-size: 28px;
    font-weight: 700;
    color: #9ca3af;
    cursor: pointer;
    margin: 0;
    transition: color 0.2s;
}

.header-tab.active {
    color: #4f46e5;
    /* Brand color */
}

.header-tab:hover {
    color: #4b5563;
}

/* Segmented Controls (Day/Month/Year & Grid) */
.sub-header-center {
    flex: 1;
    display: flex;
    justify-content: center;
}

.segmented-control {
    display: flex;
    background: #e5e7eb;
    padding: 4px;
    border-radius: 12px;
}

.segmented-control button {
    border: none;
    background: transparent;
    padding: 6px 20px;
    border-radius: 8px;
    font-size: 14px;
    font-weight: 600;
    color: #4b5563;
    cursor: pointer;
    transition: all 0.2s ease;
}

.segmented-control button.active {
    background: white;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    color: #111827;
}

.segmented-control button:hover:not(.active) {
    background: rgba(255, 255, 255, 0.5);
}

.segmented-control.small button {
    padding: 6px 12px;
    font-size: 16px;
    /* Icon size */
}

/* Right Actions */
.sub-header-right {
    display: flex;
    align-items: center;
    gap: 16px;
}

.btn-icon-round {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    border: 1px solid #e5e7eb;
    background: white;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    color: #4b5563;
    transition: all 0.2s;
    font-size: 18px;
}

.btn-icon-round:hover {
    background: #f3f4f6;
    color: #111827;
}

.btn-icon-round.active {
    background: #4f46e5;
    color: white;
    border-color: #4f46e5;
}

/* View Settings Dropdown */
.view-settings-wrapper {
    position: relative;
}

.view-settings-backdrop {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    z-index: 998;
}

.view-settings-dropdown {
    position: absolute;
    top: calc(100% + 8px);
    right: 0;
    width: 240px;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border: 1px solid rgba(0, 0, 0, 0.1);
    border-radius: 12px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.12);
    padding: 12px;
    z-index: 999;
    animation: dropdownSlideIn 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

@keyframes dropdownSlideIn {
    from {
        opacity: 0;
        transform: translateY(-10px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.dropdown-section {
    margin-bottom: 8px;
}

.dropdown-section:last-child {
    margin-bottom: 0;
}

.dropdown-label {
    font-size: 12px;
    font-weight: 600;
    color: #6b7280;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin-bottom: 8px;
}

.dropdown-options {
    display: flex;
    flex-direction: column;
    gap: 4px;
}

.dropdown-options button {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 8px 12px;
    background: transparent;
    border: 1px solid transparent;
    border-radius: 8px;
    font-size: 14px;
    font-weight: 500;
    color: #374151;
    cursor: pointer;
    transition: all 0.15s;
    text-align: left;
}

.dropdown-options button:hover {
    background: rgba(79, 70, 229, 0.05);
    border-color: rgba(79, 70, 229, 0.1);
}

.dropdown-options button.active {
    background: rgba(79, 70, 229, 0.1);
    border-color: rgba(79, 70, 229, 0.3);
    color: #4f46e5;
}

.dropdown-divider {
    height: 1px;
    background: rgba(0, 0, 0, 0.08);
    margin: 12px 0;
}

.selection-count {
    margin-left: 16px;
}

.selection-count span {
    font-size: 18px;
    font-weight: 700;
    color: #4f46e5;
}

.btn-icon-round.cancel {
    background: #fee2e2;
    color: #ef4444;
    border-color: #fecaca;
}

.btn-icon-round.cancel:hover {
    background: #fecaca;
}

.btn-text-select-all {
    background: transparent;
    border: 1px solid #4f46e5;
    color: #4f46e5;
    padding: 6px 16px;
    border-radius: 20px;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
}

.btn-text-select-all:hover {
    background: rgba(79, 70, 229, 0.05);
}

.selection-actions {
    display: flex;
    align-items: center;
    gap: 12px;
    background: #4f46e5;
    padding: 4px 12px;
    border-radius: 24px;
    box-shadow: 0 4px 12px rgba(79, 70, 229, 0.3);
    color: white;
    animation: slideInRight 0.3s ease;
}

.selection-actions .btn-secondary {
    display: flex;
    align-items: center;
    gap: 6px;
    background: rgba(255, 255, 255, 0.15);
    border: none;
    color: white;
    padding: 6px 12px;
    border-radius: 12px;
    font-size: 13px;
    font-weight: 600;
    cursor: pointer;
    transition: background 0.2s;
}

.selection-actions .btn-secondary:hover {
    background: rgba(255, 255, 255, 0.3);
}

.selection-actions .btn-secondary.danger {
    background: rgba(239, 68, 68, 0.8);
}

@keyframes slideInRight {
    from {
        transform: translateX(20px);
        opacity: 0;
    }

    to {
        transform: translateX(0);
        opacity: 1;
    }
}

/* Timeline Content Area */
.timeline-content {
    /* 
       Ensure content doesn't get hidden behind the sticky header initially 
       Sticky header takes space in flow, so padding here is just aesthetic spacing.
       But if flex layout collapses, we might need min-height?
    */
    padding: 24px 40px 40px 40px;
}

/* Timeline Date Headers */
.group-header {
    font-size: 1.5rem;
    font-weight: 700;
    color: #111827;
    margin-bottom: 16px;
    margin-top: 32px;
    padding-left: 8px;
    /* Align with grid gutter visual */
    text-transform: capitalize;
}

/* Ensure the first header doesn't have excessive top margin if it's right under the sticky header */
.date-group:first-child .group-header {
    margin-top: 16px;
}

/* Ensure sticky header has distinct separation */
.timeline-sub-header {
    /* ... existing props ... */
    backdrop-filter: blur(12px);
    background: rgba(255, 255, 255, 0.85);
    /* Slightly more opaque */
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
    /* Subtle shadow for depth */
}

.empty-state {
    text-align: center;
    padding: 120px 0;
    /* More breathing room */
    color: #9ca3af;
}

.empty-state h3 {
    font-size: 18px;
    font-weight: 500;
}

/* Masonry Grid Styles */
.my-masonry-grid {
    display: flex;
    margin-left: -16px;
    /* gutter size offset */
    width: auto;
}

.my-masonry-grid_column {
    padding-left: 16px;
    /* gutter size */
    background-clip: padding-box;
}

/* Photo Grid Masonry */
.photo-grid {
    margin-top: 20px;
}

.photo-grid.compact {
    --button-size: 28px;
    --button-icon-size: 14px;
    --hashtag-font-size: 9px;
    --hashtag-padding: 3px 6px;
}

.photo-grid.comfortable {
    --button-size: 36px;
    --button-icon-size: 16px;
    --hashtag-font-size: 11px;
    --hashtag-padding: 4px 10px;
}

.photo-grid.cozy {
    --button-size: 40px;
    --button-icon-size: 18px;
    --hashtag-font-size: 12px;
    --hashtag-padding: 5px 12px;
}

/* Photo Card Styles */
.photo-card {
    position: relative;
    border-radius: 12px;
    overflow: hidden;
    background-color: #f3f4f6;
    transform: translateZ(0);
    transition: transform 0.2s;
    margin-bottom: 16px;
    /* Vertical gutter */
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
}

.photo-card img {
    display: block;
    width: 100%;
    height: auto;
    object-fit: cover;
    transition: filter 0.2s;
}

/* Photo Selection Indicator */
.photo-selection-indicator {
    position: absolute;
    top: 12px;
    left: 12px;
    z-index: 30;
    cursor: pointer;
}

.selection-checkmark {
    width: 28px;
    height: 28px;
    border-radius: 8px;
    background: rgba(255, 255, 255, 0.9);
    border: 2px solid #d1d5db;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    color: transparent;
}

.photo-selection-indicator.selected .selection-checkmark {
    background: #4f46e5;
    border-color: #4f46e5;
    color: white;
    transform: scale(1.1);
    box-shadow: 0 4px 10px rgba(79, 70, 229, 0.4);
}

.photo-card.selected {
    box-shadow: 0 0 0 3px #4f46e5, 0 8px 20px rgba(79, 70, 229, 0.2);
    transform: scale(0.97);
}

/* Visual Hashtags Relocated */
.visual-hashtags-container {
    position: absolute;
    bottom: 60px;
    /* Above the action buttons */
    right: 12px;
    /* Aligned to the right */
    left: auto;
    z-index: 25;
    pointer-events: auto;
    display: flex;
    justify-content: flex-end;
    /* Right-align hashtags */
    transition: opacity 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    opacity: 0;
}

.photo-card:hover .visual-hashtags-container {
    opacity: 1;
}

/* Slide up slightly on hover to make room for full bottom overlay if needed, 
   or just keep it fixed and ensure buttons are above it. */
.photo-card:hover .visual-hashtags-container {
    transform: none;
}

.visual-hashtags {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
}

.visual-hashtag {
    background: rgba(255, 255, 255, 0.2);
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
    color: white;
    padding: var(--hashtag-padding, 4px 10px);
    border-radius: 10px;
    font-size: var(--hashtag-font-size, 11px);
    font-weight: 600;
    letter-spacing: 0.02em;
    border: 1px solid rgba(255, 255, 255, 0.2);
    white-space: nowrap;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    cursor: pointer;
    text-decoration: none;
    display: inline-block;
    transition: all 0.2s;
}

.visual-hashtag:hover {
    background: rgba(255, 255, 255, 0.4);
    transform: translateY(-2px);
}

/* Photo Overlay */
.photo-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(to bottom,
            rgba(0, 0, 0, 0.3) 0%,
            transparent 30%,
            transparent 70%,
            rgba(0, 0, 0, 0.5) 100%);
    opacity: 0;
    transition: opacity 0.25s cubic-bezier(0.4, 0, 0.2, 1);
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    padding: 12px;
    pointer-events: none;
}

.photo-card:hover .photo-overlay {
    opacity: 1;
}

.photo-overlay button {
    pointer-events: auto;
    background: rgba(255, 255, 255, 0.15);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 50%;
    width: var(--button-size, 36px);
    height: var(--button-size, 36px);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    color: white;
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.photo-overlay button svg {
    width: var(--button-icon-size, 16px);
    height: var(--button-icon-size, 16px);
}

.photo-overlay button:hover {
    background: rgba(255, 255, 255, 0.25);
    border-color: rgba(255, 255, 255, 0.4);
    transform: scale(1.1) translateY(-2px);
    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.25);
}

.photo-overlay button:active {
    transform: scale(0.95);
}

.favorite-btn {
    align-self: flex-end;
}

.favorite-btn.favorited {
    background: rgba(239, 68, 68, 0.9);
    border-color: rgba(239, 68, 68, 1);
    color: white;
}

.favorite-btn.favorited:hover {
    background: rgba(239, 68, 68, 1);
    box-shadow: 0 6px 20px rgba(239, 68, 68, 0.4);
}

.delete-btn {
    position: absolute !important;
    top: 12px !important;
    left: 12px !important;
    background: rgba(239, 68, 68, 0.9) !important;
    border-color: rgba(239, 68, 68, 0.95) !important;
    color: white !important;
    width: calc(var(--button-size, 36px) + 4px) !important;
    height: calc(var(--button-size, 36px) + 4px) !important;
}

.delete-btn:hover {
    background: rgba(239, 68, 68, 1) !important;
    border-color: rgba(239, 68, 68, 1) !important;
    box-shadow: 0 8px 24px rgba(239, 68, 68, 0.5) !important;
    transform: scale(1.05) !important;
}

.overlay-bottom {
    display: flex;
    gap: 10px;
    justify-content: flex-end;
    align-items: center;
    width: 100%;
}




/* Media Queries */
@media (max-width: 1000px) {
    .timeline-wrapper {
        margin: -16px;
        /* Mobile padding is 16px */
    }

    .timeline-sub-header {
        flex-direction: column;
        gap: 16px;
        align-items: flex-start;
        padding: 16px 20px;
        top: 0;
    }

    /* ... rest of media query ... */

    .sub-header-center {
        width: 100%;
        justify-content: flex-start;
    }

    .sub-header-right {
        width: 100%;
        justify-content: space-between;
    }

    .timeline-content {
        padding: 10px 20px;
    }
}