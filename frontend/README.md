# PhotoBomb Frontend

React PWA for PhotoBomb photo storage service.

## Quick Start

### Development

```bash
# Install dependencies
npm install

# Start dev server (with API proxy to backend)
npm run dev

# Open browser at http://localhost:3000
```

### Build for Production

```bash
# Build optimized bundle
npm run build

# Preview production build
npm preview
```

## Features

✅ **Authentication**
- Login/Register with JWT tokens
- Automatic token refresh
- Protected routes

✅ **Photo Timeline**
- Responsive photo grid
- Lazy loading images
- Empty state

✅ **Upload**
- File selection
- Direct B2 upload via presigned URLs
- Progress tracking

✅ **PWA**
- Service worker with Workbox
- Offline-capable
- Add to Home Screen (manifest.json)
- API response caching
- Thumbnail caching

## Project Structure

```
frontend/
├── public/
│   └── icons/              # PWA icons (add 192x192 and 512x512)
├── src/
│   ├── components/         # Reusable components (future)
│   ├── context/
│   │   └── AuthContext.jsx # Auth state management
│   ├── pages/
│   │   ├── Login.jsx
│   │   ├── Register.jsx
│   │   ├── Timeline.jsx
│   │   └── Upload.jsx
│   ├── services/
│   │   └── api.js          # Axios client with interceptors
│   ├── App.jsx             # Main app with routing
│   ├── main.jsx            # Entry point
│   └── index.css           # Global styles
├── vite.config.js          # Vite + PWA config
└── package.json
```

## API Integration

The frontend connects to the backend API (default: `http://localhost:8000`).

**Endpoints used:**
- `POST /api/v1/auth/register`
- `POST /api/v1/auth/login`
- `POST /api/v1/auth/refresh`
- `GET /api/v1/auth/me`
- `GET /api/v1/photos`
- `POST /api/v1/upload/presign`
- `POST /api/v1/upload/confirm`

API proxy is configured in `vite.config.js` for development.

## PWA Features

### Service Worker
Automatically generated by `vite-plugin-pwa` with Workbox:
- **NetworkFirst** for API calls (5 min cache)
- **CacheFirst** for thumbnails (7 day cache)
- Offline fallback

### Manifest
See `vite.config.js` for PWA manifest configuration.

**Install prompts:**
- Android Chrome: Automatic after 30s browsing
- iOS Safari: Manual "Add to Home Screen"

## Styling

CSS Variables defined in `index.css`:
- `--primary`: #4F46E5 (Indigo)
- `--bg`: #F9FAFB (Light gray)
- Responsive breakpoints

**Design principles:**
- Mobile-first responsive
- Clean, modern UI
- Accessible form inputs
- Smooth transitions

## Next Steps

Current frontend covers **MVP Milestone 1** basics:
- ✅ Auth flow
- ✅ Timeline view
- ✅ Upload flow

**To add:**
- [ ] Infinite scroll pagination
- [ ] Photo detail modal
- [ ] Edit caption
- [ ] Offline upload queue (IndexedDB)
- [ ] Albums
- [ ] Search

## Testing Locally

1. **Start backend first:**
   ```bash
   cd ..
   docker-compose up -d
   ```

2. **Start frontend:**
   ```bash
   npm run dev
   ```

3. **Test flow:**
   - Register account at http://localhost:3000/register
   - Upload a photo
   - View timeline

## Troubleshooting

**CORS errors:**
- Ensure backend has `localhost:3000` in `ALLOWED_ORIGINS`
- Check Vite proxy config

**401 errors:**
- Check JWT tokens in localStorage
- Token might be expired (should auto-refresh)

**Upload fails:**
- Verify B2 credentials in backend
- Check presigned URL generation
